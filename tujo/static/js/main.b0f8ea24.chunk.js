(this.webpackJsonpjournal=this.webpackJsonpjournal||[]).push([[0],{1018:function(e,t,n){"use strict";n.r(t);n(18);window.Go.setWasmPath("./tupelo.wasm");var r=n(0),a=n.n(r),c=n(65),u=n.n(c),o=n(5),i=n.n(o),s=n(17),l=n(9),p=n(76),f=n(77),m=n(459);function b(e){var t=e.isAuthenticated,n=e.children,r=Object(m.a)(e,["isAuthenticated","children"]);return a.a.createElement(f.b,Object.assign({},r,{render:function(e){var r=e.location;return t?n:a.a.createElement(f.a,{to:{pathname:"/login",state:{from:r}}})}}))}var h=n(1031),v=n(1032),d=n(61);var y=function(e){var t=Object(f.h)().username,n=Object(r.useState)(),c=Object(l.a)(n,2),u=c[0],o=c[1];Object(r.useEffect)((function(){function e(){return(e=Object(s.a)(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.e)(t);case 2:n=e.sent,console.log(n),n?d.a.fromDID(n).then(o):d.a.fromKey().then(o);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t]);var p=a.a.Children.toArray(e.children).map((function(e){return a.a.cloneElement(e,{tupelo:u})}));return void 0===u?a.a.createElement("p",null,"Loading ChainTree, please wait..."):p},w=n(1040),O=n(1042),j=function(e){return a.a.createElement(v.a,Object.assign({tag:"header",direction:"row",align:"center",justify:"between",background:"brand",pad:{left:"medium",right:"small",vertical:"small"},elevation:"medium",style:{zIndex:"1"}},e),a.a.createElement(w.a,null,"tujo"),a.a.createElement(p.b,{to:"/"},a.a.createElement(O.a,{label:"Home"})),a.a.createElement(p.b,{to:"/settings"},a.a.createElement(O.a,{label:"Settings"})))},g=n(1041);var x=function(e){var t=e.tupelo,n=Object(r.useState)("Unknown"),c=Object(l.a)(n,2),u=c[0],o=c[1];return Object(r.useEffect)((function(){console.log("header",t),t.get("username").then(o)}),[t]),a.a.createElement(g.a,{level:1},u,"'s Journal")},E=n(456),k=n(451),T=n(1035),S=n(1039),D=n(1028),C=n(1037),K=n(1030),P=n(60);var I=function(e){var t=e.onSubmit,n=e.value,c=Object(r.useState)(n||P.a.get("post","")),u=Object(l.a)(c,2),o=u[0],p=u[1];function f(){return(f=Object(s.a)(i.a.mark((function e(n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,t(o);case 3:if(!e.sent){e.next=5;break}return e.abrupt("return");case 5:p(""),P.a.set("post","");case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){var e=window.setInterval((function(){P.a.set("post",o)}),1e3);return function(){return clearInterval(e)}}),[o]),a.a.createElement(v.a,{pad:{bottom:"medium"},margin:{bottom:"medium"}},a.a.createElement(D.a,{onSubmit:function(e){return f.apply(this,arguments)}},a.a.createElement(C.a,{fill:!0,placeholder:"Describe your activity. You can use **Markdown**!",value:o,onChange:function(e){return p(e.target.value)}}),a.a.createElement(O.a,{icon:a.a.createElement(K.a,null),type:"submit",label:"Submit"})))},A=n(454),L=n.n(A),B=n(455),U=n.n(B);function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(n,!0).forEach((function(t){Object(k.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var W=function(e){var t=e.tupelo,n=e.date,c=e.path,u=Object(r.useState)(!1),o=Object(l.a)(u,2),p=o[0],f=o[1],m=Object(r.useState)({}),b=Object(l.a)(m,2),h=b[0],d=b[1],y=(new Date).toISOString().split("T"),w=Object(l.a)(y,1)[0];function O(e,t,n){return j.apply(this,arguments)}function j(){return(j=Object(s.a)(i.a.mark((function e(n,r,a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.set(["entries",r,a].join("/"),n);case 2:e.sent,h[a]=n,d(N({},h));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return(x=Object(s.a)(i.a.mark((function e(t){var n,r,a,c,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(new Date).toISOString(),r=n.split("T"),a=Object(l.a)(r,2),c=a[0],u=(u=a[1]).slice(0,-1),e.abrupt("return",O(t,c,u));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return(E=Object(s.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(t,n,r);case 2:return f(""),e.abrupt("return",!0);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(t);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=Object(s.a)(i.a.mark((function e(r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.set(["entries",n,r].join("/"),"");case 2:e.sent,delete h[r],d(N({},h));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(r.useEffect)((function(){function e(){return(e=Object(s.a)(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get(c,{});case 2:n=e.sent,d(n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,c]);var C={},K=Object.keys(h);return K.sort(),K.reverse(),K.forEach((function(e){return""!==h[e]&&(C[e]=h[e])})),a.a.createElement(v.a,null,a.a.createElement(g.a,{level:2},n),w===n&&t.key&&a.a.createElement(I,{onSubmit:function(e){return x.apply(this,arguments)}}),p&&a.a.createElement(T.a,{onEsc:function(){return f(!1)},onClickOutside:function(){return f(!1)}},a.a.createElement(v.a,{pad:"large"},a.a.createElement(I,{value:h[p],onSubmit:function(e){return function(e,t){return E.apply(this,arguments)}(e,p)}}))),Object.entries(C).map((function(e){var n=Object(l.a)(e,2),r=n[0],c=n[1];return a.a.createElement(v.a,{fill:!0,border:"left",pad:{left:"small"},margin:"small",key:r},a.a.createElement("div",{dangerouslySetInnerHTML:{__html:U.a.sanitize(L()(c))}}),t.key&&a.a.createElement(v.a,null,a.a.createElement(S.a,{size:"small",label:"actions",items:[{label:"Edit",onClick:function(){return function(e){return k.apply(this,arguments)}(r)}},{label:"Delete",onClick:function(){return function(e){return D.apply(this,arguments)}(r)}}]})))})))};var _=function(e){var t=e.tupelo,n=Object(r.useState)([]),c=Object(l.a)(n,2),u=c[0],o=c[1];return Object(r.useEffect)((function(){function e(){return(e=Object(s.a)(i.a.mark((function e(){var n,r,a,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(new Date).toISOString().split("T"),r=Object(l.a)(n,1),a=r[0],e.t0=Object,e.next=4,t.get("entries",{});case 4:e.t1=e.sent,c=e.t0.keys.call(e.t0,e.t1),console.log("getentries",c),c.sort(),c.reverse(),c.includes(a)||(c=[a].concat(Object(E.a)(c))),o(c);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t]),a.a.createElement(v.a,null,u.map((function(e){return a.a.createElement(W,{key:e,tupelo:t,date:e,path:["entries",e].join("/")})})))},z="https://quorumcontrol.github.io/wasm-explorer/build/#/chaintrees/";var M=function(e){var t=e.tupelo,n=Object(r.useState)(""),c=Object(l.a)(n,2),u=c[0],o=c[1],i=Object(r.useState)(""),s=Object(l.a)(i,2),p=(s[0],s[1]);return Object(r.useEffect)((function(){t.get("name").then(p),t.tree.id().then(o)}),[t]),a.a.createElement(v.a,null,a.a.createElement(v.a,{margin:{top:"large"}},"Your DID is:"," ",a.a.createElement("a",{target:"_blank",href:z+u},u)),a.a.createElement(v.a,{margin:{top:"large"}},a.a.createElement(O.a,{label:"Logout",onClick:function(){P.a.remove("tupelo:privateKey"),window.location.reload()}})))},H=n(1038),F=n(1033),Y=n(1034);var q=function(e){var t=e.onLogin,n=Object(f.g)(),c=Object(r.useState)(!1),u=Object(l.a)(c,2),o=u[0],p=u[1],m=Object(r.useState)(""),b=Object(l.a)(m,2),h=b[0],y=b[1],w=Object(r.useState)(""),j=Object(l.a)(w,2),g=j[0],x=j[1];function E(){return(E=Object(s.a)(i.a.mark((function e(){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(d.d)(h,g);case 3:return r=e.sent,e.next=6,t(r);case 6:n.replace("/"),e.next=16;break;case 9:if(e.prev=9,e.t0=e.catch(0),console.log("error",e.t0),"wrong password"===e.t0.toString()){e.next=14;break}throw e.t0;case 14:p(!0),x("");case 16:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}return a.a.createElement(v.a,{pad:"large"},o&&a.a.createElement(v.a,{background:"status-error",align:"center"},a.a.createElement(H.a,null,"Wrong Password")),a.a.createElement(D.a,{onSubmit:function(){return E.apply(this,arguments)}},a.a.createElement(F.a,{label:"Username"},a.a.createElement(Y.a,{value:h,onChange:function(e){return y(e.target.value)}})),a.a.createElement(F.a,{label:"Password"},a.a.createElement(Y.a,{type:"password",value:g,onChange:function(e){return x(e.target.value)}})),a.a.createElement(O.a,{type:"submit",label:"Login"})))},G={global:{font:{family:"monospace",size:"18px",height:"20px"}}};var $=function(){var e=Object(r.useState)("Loading Tupelo WASM SDK"),t=Object(l.a)(e,2),n=t[0],c=t[1],u=Object(r.useState)(),o=Object(l.a)(u,2),m=o[0],w=o[1];function O(){return(O=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.fromKey(t);case 2:n=e.sent,w(n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return window.tupelo=m,Object(r.useEffect)((function(){function e(){return(e=Object(s.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.c)();case 2:return c("Connecting to Network"),e.next=5,Object(d.b)();case 5:if(!(t=e.sent)){e.next=11;break}return e.next=9,d.a.fromKey(t);case 9:n=e.sent,w(n);case 11:c(null);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),console.log("render",m),n?a.a.createElement("p",null,n,", please wait..."):a.a.createElement(h.a,{theme:G,full:!0},a.a.createElement(p.a,null,a.a.createElement(v.a,{align:"center"},a.a.createElement(v.a,{fill:!0},a.a.createElement(j,null)),a.a.createElement(v.a,{width:"large"},a.a.createElement(f.d,null,a.a.createElement(b,{exact:!0,path:"/",isAuthenticated:m},a.a.createElement(x,{tupelo:m}),a.a.createElement(_,{tupelo:m})),a.a.createElement(f.b,{exact:!0,path:"/journal/:username"},a.a.createElement(y,null,a.a.createElement(x,null),a.a.createElement(_,null))),a.a.createElement(b,{path:"/settings",isAuthenticated:m},a.a.createElement(M,{tupelo:m})),a.a.createElement(f.b,{path:"/login"},a.a.createElement(q,{onLogin:function(e){return O.apply(this,arguments)}})))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(a.a.createElement($,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},219:function(e,t){},462:function(e,t,n){e.exports=n(1018)},491:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=491},493:function(e,t){},495:function(e,t){},527:function(e,t){},528:function(e,t){},575:function(e,t){},60:function(e,t,n){"use strict";var r=n(91),a=n(110),c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:localStorage;Object(r.a)(this,e),this.storage=t}return Object(a.a)(e,[{key:"get",value:function(e,t){var n=this.storage.getItem(e);return null===n?t:JSON.parse(n)}},{key:"set",value:function(e,t,n){var r;t instanceof Function?r=t(this.get(e,n)):r=t;return this.storage.setItem(e,JSON.stringify(r)),r}},{key:"has",value:function(e){return void 0!==this.storage[e]}},{key:"remove",value:function(e){this.storage.removeItem(e)}}]),e}();t.a=new c},61:function(e,t,n){"use strict";(function(e){n.d(t,"e",(function(){return m})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return j}));var r=n(5),a=n.n(r),c=n(91),u=n(110),o=n(17),i=n(60),s=n(18);window.Tupelo=s.Tupelo,window.Community=s.Community,window.ChainTree=s.ChainTree,window.EcdsaKey=s.EcdsaKey,window.setDataTransaction=s.setDataTransaction;var l="https://vrde.github.io/apps/tojo";function p(e){return f.apply(this,arguments)}function f(){return(f=Object(o.a)(a.a.mark((function t(n){var r,c;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.from(n),t.next=3,crypto.subtle.digest("SHA-256",r);case 3:return c=t.sent,t.abrupt("return",new Uint8Array(c));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function m(e){return b.apply(this,arguments)}function b(){return(b=Object(o.a)(a.a.mark((function e(t){var n,r,c,u,o,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Community.getDefault();case 2:return n=e.sent,e.next=5,p([l,t].join(":"));case 5:return r=e.sent,e.next=8,s.EcdsaKey.fromBytes(r);case 8:return c=e.sent,e.next=11,s.Tupelo.ecdsaPubkeyToDid(c.publicKey);case 11:return u=e.sent,e.prev=12,e.next=15,n.getTip(u);case 15:return o=e.sent,i=new s.ChainTree({store:n.blockservice,tip:o}),e.next=19,i.resolve("/tree/data/owner");case 19:return e.abrupt("return",e.sent.value);case 22:if(e.prev=22,e.t0=e.catch(12),"not found"===e.t0.toString()){e.next=26;break}throw e.t0;case 26:case"end":return e.stop()}}),e,null,[[12,22]])})))).apply(this,arguments)}function h(){return v.apply(this,arguments)}function v(){return(v=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.EcdsaKey.generate();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e,t){return y.apply(this,arguments)}function y(){return(y=Object(o.a)(a.a.mark((function e(t,n){var r,c,u,o,f,m,b,h,v,d,y,w,O;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Community.getDefault();case 2:return r=e.sent,e.next=5,p([l,t].join(":"));case 5:return c=e.sent,e.next=8,s.EcdsaKey.fromBytes(c);case 8:return u=e.sent,e.next=11,s.Tupelo.ecdsaPubkeyToDid(u.publicKey);case 11:return o=e.sent,e.next=14,p([l,t,n].join(":"));case 14:return f=e.sent,e.next=17,s.EcdsaKey.fromBytes(f);case 17:return m=e.sent,e.next=20,s.Tupelo.ecdsaPubkeyToAddress(m.publicKey);case 20:return b=e.sent,e.next=23,s.Tupelo.ecdsaPubkeyToDid(m.publicKey);case 23:return h=e.sent,e.prev=24,e.next=27,r.getTip(o);case 27:return d=e.sent,y=new s.ChainTree({store:r.blockservice,tip:d}),e.next=31,y.resolve("/tree/data/owner");case 31:v=e.sent.value,e.next=38;break;case 34:if(e.prev=34,e.t0=e.catch(24),"not found"===e.t0.toString()){e.next=38;break}throw e.t0;case 38:if(v){e.next=51;break}return e.next=41,s.ChainTree.newEmptyTree(r.blockservice,u);case 41:return w=e.sent,e.next=44,r.playTransactions(w,[Object(s.setDataTransaction)("username",t),Object(s.setDataTransaction)("owner",h),Object(s.setOwnershipTransaction)([b])]);case 44:return e.next=46,s.ChainTree.newEmptyTree(r.blockservice,m);case 46:return O=e.sent,e.next=49,r.playTransactions(O,[Object(s.setDataTransaction)("username",t),Object(s.setDataTransaction)("claim",o)]);case 49:e.next=53;break;case 51:if(v===h){e.next=53;break}throw"wrong password";case 53:return i.a.set("tupelo:privateKey",Array.from(m.privateKey)),e.abrupt("return",m);case 55:case"end":return e.stop()}}),e,null,[[24,34]])})))).apply(this,arguments)}function w(){return O.apply(this,arguments)}function O(){return(O=Object(o.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.a.has("tupelo:privateKey")){e.next=2;break}return e.abrupt("return");case 2:return t=new Uint8Array(i.a.get("tupelo:privateKey")),e.abrupt("return",s.EcdsaKey.fromBytes(t));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}window.sha256=p,window.usernameToDid=m,window.login=d;var j=function(){function e(t,n){Object(c.a)(this,e),this.key=t,this.did=n}return Object(u.a)(e,[{key:"init",value:function(){var e=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Community.getDefault();case 2:this.community=e.sent;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getTip",value:function(){var e=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.community.getTip(this.did);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"set",value:function(){var e=Object(o.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.community.playTransactions(this.tree,[Object(s.setDataTransaction)(t,n)]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(o.a)(a.a.mark((function e(t,n){var r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tree.resolve("/tree/data/"+t);case 2:return r=e.sent,r.remaining,c=r.value,e.abrupt("return",null===c?n:c);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(o.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.community.playTransactions(this.tree,[Object(s.setDataTransaction)(t,void 0)]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"fromKey",value:function(){var t=Object(o.a)(a.a.mark((function t(n){var r,c,u,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new e(n),t.next=3,r.init();case 3:return t.next=5,s.ChainTree.newEmptyTree(r.community.blockservice,n);case 5:return c=t.sent,t.next=8,c.id();case 8:return u=t.sent,t.prev=9,t.next=12,r.community.getTip(u);case 12:o=t.sent,r.tree=new s.ChainTree({store:r.community.blockservice,tip:o,key:n}),t.next=21;break;case 16:if(t.prev=16,t.t0=t.catch(9),"not found"===t.t0.toString()){t.next=20;break}throw t.t0;case 20:r.tree=c;case 21:return t.next=23,r.tree.id();case 23:return r.did=t.sent,t.abrupt("return",r);case 25:case"end":return t.stop()}}),t,null,[[9,16]])})));return function(e){return t.apply(this,arguments)}}()},{key:"fromDID",value:function(){var t=Object(o.a)(a.a.mark((function t(n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new e(null,n),t.next=3,r.init();case 3:return t.t0=s.ChainTree,t.t1=r.community.blockservice,t.next=7,r.getTip();case 7:return t.t2=t.sent,t.t3={store:t.t1,tip:t.t2},r.tree=new t.t0(t.t3),t.abrupt("return",r);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}();window.Store=j}).call(this,n(2).Buffer)},671:function(e,t){},956:function(e,t){},958:function(e,t){}},[[462,1,2]]]);
//# sourceMappingURL=main.b0f8ea24.chunk.js.map